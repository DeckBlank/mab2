{% extends '_html.twig' %}

{% block hero %}
  {% include 'templates-parts/hero.twig' %}
{% endblock %}

{% block content %}

  {% set source = post.get_field('source') %}

  <section ref="video" class="c-section c-section--video bg-pri-alt" data-id="{{post.id}}">
    <div class="grid-container padding-vertical-3">
      <div class="grid-x align-center">
        <div class="cell medium-10 large-8">
          <section class="bg-white br--medium padding-2">
            <h3 class="fs-40 f1 w-bold dark-gray margin-bottom-2">{{post.title}}</h3>
            <div class="c-details flex-container align-justify margin-bottom-2">
              <div class="flex-container align-middle">
                {% set author_avatar = author.avatar['sizes']['thumbnail'] %}
  
                <figure class="c-avatar margin-right-1 overflow-hidden rounded">
                  <img src="{{author_avatar}}" alt="">
                </figure>
                <p class="margin-bottom-0 fs-21 w-medium f2 dark">{{author.first_name}} {{author.last_name}}</p>
              </div>
              <div class="c-details__label f2 fs-21 flex-container align-middle">
                <span class="c-icon"><i class="far fa-gift"></i></span>
                <p class="margin-left-1 margin-bottom-0 w-medium">Contenido gratuito</p>
              </div>        
            </div>
            <div class="c-player margin-bottom-1">
              <div style="padding:56.25% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/{{source|split('/')[3]}}?color=de0d46&title=0&byline=0" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div>
            </div>
            <div class="flex-container align-justify margin-bottom-3">
              <likes :average="likesAverage" :target="{ id : {{post.id}}, type: 'video' }"></likes>
  
              {% if post.terms[0] %}
                <a href="{{site.url}}?category={{post.terms[0].slug}}" class="c-category f2 rounded display-block">
                  {{post.terms[0].name}}
                </a>
              {% endif %}
            </div>
            <div class="c-comments f2">
              <div class="c-counter flex-container align-middle margin-bottom-2">
                <span class="c-counter__icon"><i class="far fa-comment-lines fs-21"></i></span>
                <p v-if="comments.number > 1 || comments.number == 0" class="margin-bottom-0 fs-18  gray-gray">${comments.number} comentarios</p>
                <p v-else class="margin-bottom-0 fs-18 gray-gray">${comments.number} comentario</p>
              </div>
              <div class="flex-container margin-bottom-2">
                <div class="margin-right-1">
                  <figure class="c-avatar overflow-hidden rounded">
                    <img src="{{theme.link}}/static/images/user.png" alt="">
                  </figure>
                </div>
                <div class="width-100">
                  <editor :target="{ id: {{post.id}}, type: 'post'}" :post="{ type: 'video' }" :thread.sync="comments"></editor>
                </div>
              </div>
              <div class="c-loading text-center gray-gray padding-vertical-1" :class="{ hide : !isLoadingComments }">
                Cargando comentarios...
              </div>
              <div class="c-thread">
                <comment v-for="comment of comments.list" :body="comment" :post="{ type: 'video', id: {{post.id}} }" :key="comment.id" pic="{{theme.link}}/static/images/user.png"></comment>           
                <button v-if="commentsPaged != -1 && comments.list.length != 0 && comments.list.length/commentsPaged >= 5 " class="sec-alt flex-container align-middle" @click="getComments">
                  <span class="c-icon margin-right-1"><i class="far fa-ellipsis-h"></i></span> 
                  <p class="margin-bottom-0">Mostrar m√°s comentarios</p>
                </button>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </section>
{% endblock %}
